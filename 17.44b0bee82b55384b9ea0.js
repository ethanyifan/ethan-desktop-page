(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"dc/v":function(t,n,i){"use strict";i.r(n),i.d(n,"TerminalApp",function(){return b}),i.d(n,"TerminalAppModule",function(){return C});var e=i("PCNd"),r=i("nd0x"),s=i("fXoL"),o=i("YLzM"),u=i("aYRI"),p=i("CFL1"),h=i("vv9Y"),c=i("L7HW");let a=(()=>{class t{constructor(t,n,i,e,r){this.EAS=t,this.toastSrv=n,this.userSrv=i,this.timeSrv=e,this.configSrv=r,this.typingHistory=[""],this.DANGER_COMMAND=["\u5371\u9669\u6307\u4ee4","null","wa$%\u53e3\u53e3\u53e3","shit","fuck","\u5783\u573e\u7cfb\u7edf","\u6211\u7231\u4f60","\u5173\u673a","shutdown","dangerous"]}pushHistory(t){for(let n=0;n<this.typingHistory.length;n++)if(this.typingHistory[n]==t){this.typingHistory.splice(n,1);break}this.typingHistory.push(t)}clearHistory(){this.typingHistory=[""]}start(t,n){if(Object(r.l)(t,this.DANGER_COMMAND)&&(t="rickroll"),"\u5e2e\u52a9"==t&&(t="help"),!this[t])return`"${t}"\u6307\u4ee4\u65e0\u6548\uff0c\u8bf7\u68c0\u67e5\u8f93\u5165\uff0c\u6216\u8f93\u5165 help terminal \u67e5\u770b\u5e2e\u52a9\u624b\u518c`;n&&n.length||(n=[""]);let i=[];for(let e=0;e<n.length;e++){let r=this[t](n[e]);if("FAIL"==r.status)return r.msg||"";r.msg&&i.push(r.msg)}return i.join(" | ")}help(t){return this.EAS.launch("help",{category:t}),{status:"SUCCESS"}}run(t){return t?this.EAS.apps[t]?(this.EAS.launch(t),{status:"SUCCESS"}):{status:"FAIL",msg:`Key\u4e3a"${t}"\u7684App\u4e0d\u5b58\u5728`}:{status:"FAIL",msg:"\u8bf7\u8f93\u5165App Key\uff0c\u5982 run setting"}}ipconfig(){return{status:"SUCCESS",msg:`\u672c\u673aIP\uff1a${this.userSrv.userInfo.ip}`}}time(){return{status:"SUCCESS",msg:`\u5f53\u524d\u65f6\u95f4\uff1a${this.timeSrv.current}`}}date(){return this.time()}exit(){return Object(r.e)(()=>{this.EAS.closeApp("terminal")},1e3),{status:"SUCCESS",msg:"\u6b63\u5728\u5173\u95ed\u7ec8\u7aef"}}version(){return{status:"SUCCESS",msg:`\u5f53\u524d\u7cfb\u7edf\u7248\u672c\uff1a${this.configSrv.VERSION}`}}tasklist(){return this.EAS.launch("runningApps"),{status:"SUCCESS"}}control(){return this.EAS.launch("setting"),{status:"SUCCESS"}}net(t){switch(t){case"user":this.EAS.launch("setting",{activeSettingKey:"account"})}return{status:"SUCCESS"}}rickroll(){let t="Ah shit here we go again...";return this.toastSrv.info(t),Object(r.e)(()=>{this.EAS.launch("hydrogenBrowser",{src:"https://www.bilibili.com/video/BV1GJ411x7h7"})},2e3),{status:"SUCCESS",msg:t}}}return t.\u0275fac=function(n){return new(n||t)(s.Zb(o.a),s.Zb(u.a),s.Zb(p.a),s.Zb(h.a),s.Zb(c.a))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var l=i("xLnw"),g=i("D8zh"),y=i("ofXK"),S=i("Dlr0");const m=["typingInput"];function f(t,n){1&t&&(s.Qb(0,"div",8),s.fc(1,"safeHtml")),2&t&&s.kc("innerHtml",s.gc(1,1,n.$implicit),s.tc)}let b=(()=>{class t{constructor(t,n,i,e,r){this.EAS=t,this.terminalAppSrv=n,this.userSrv=i,this.configSrv=e,this.EMS=r,this.menu=[{name:"\u5e2e\u52a9",children:[{name:"\u7ec8\u7aef\u6307\u4ee4\u624b\u518c",click:()=>{this.help()}}]}],this.titleBarConfig={showBorder:!1,color:"white",background:"black"},this.upDownCurrent=this.terminalAppSrv.typingHistory.length-1,this.output=[],this.EAS.setAppActionBarMenu("terminal",this.menu)}ngOnInit(){this.init()}init(){this.output=[`Ethan Desktop ${this.configSrv.VERSION}<br/>\u8bf7\u52ff\u8f93\u5165\u5371\u9669\u6307\u4ee4\uff0c\u8c22\u8c22\u5408\u4f5c<br/>Please do not enter dangerous commands, thank you`],this.typing=""}help(){this.EAS.launch("help",{category:"terminal"})}onKeydown(t){if(this.typing=t.target.textContent,"Enter"==t.key&&(Object(r.e)(()=>{this.typingInput.nativeElement.innerHTML=""}),Object(r.r)(this.typing))){if(this.terminalAppSrv.pushHistory(this.typing),this.upDownCurrent=this.terminalAppSrv.typingHistory.length-1,"cls"==this.typing)return void this.init();let t=this.typing.split(" "),n=t[0];t.splice(0,1),this.output.push(`${this.userSrv.userInfo.name}>${this.typing}<br/>${this.terminalAppSrv.start(n,t)}`),this.typing=""}const n=this.terminalAppSrv.typingHistory;if("ArrowDown"==t.key){if(this.upDownCurrent==n.length-1)return;this.typing=n[++this.upDownCurrent],this.typingInput.nativeElement.innerHTML=this.typing}if("ArrowUp"==t.key){if(this.upDownCurrent==this.terminalAppSrv.typingHistory.length-1&&this.typing!=n[this.upDownCurrent])return this.typing=n[this.upDownCurrent],void(this.typingInput.nativeElement.innerHTML=this.typing);if(1==this.upDownCurrent)return;this.typing=n[--this.upDownCurrent],this.typingInput.nativeElement.innerHTML=this.typing}}onMousedown(t){2==t.button&&this.EMS.create({menu:[{name:"\u6e05\u7a7a\u8f93\u51fa",click:()=>{this.init()}},{name:"\u6e05\u7a7a\u5386\u53f2\u8bb0\u5f55",click:()=>{this.upDownCurrent=this.terminalAppSrv.typingHistory.length-1,this.terminalAppSrv.clearHistory()}}]},[t.x,t.y])}}return t.\u0275fac=function(n){return new(n||t)(s.Pb(o.a),s.Pb(a),s.Pb(p.a),s.Pb(c.a),s.Pb(l.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["ng-component"]],viewQuery:function(t,n){if(1&t&&s.Ec(m,1),2&t){let t;s.pc(t=s.dc())&&(n.typingInput=t.first)}},decls:9,vars:3,consts:[[3,"titleBarConfig"],[1,"terminal","full-parent-scroll","p-md",3,"click","mousedown"],[1,"output-block"],["class","output-line mb-md",3,"innerHtml",4,"ngFor","ngForOf"],[1,"typing-block","flex-row"],[1,"typing-user"],["contenteditable","true",1,"typing-input",3,"keydown"],["typingInput",""],[1,"output-line","mb-md",3,"innerHtml"]],template:function(t,n){if(1&t){const t=s.Wb();s.Vb(0,"e-app",0),s.Vb(1,"div",1),s.cc("click",function(){return s.sc(t),s.qc(8).focus()})("mousedown",function(t){return n.onMousedown(t)}),s.Vb(2,"div",2),s.yc(3,f,2,3,"div",3),s.Ub(),s.Vb(4,"div",4),s.Vb(5,"div",5),s.Ac(6),s.Ub(),s.Vb(7,"div",6,7),s.cc("keydown",function(t){return n.onKeydown(t)}),s.Ub(),s.Ub(),s.Ub(),s.Ub()}2&t&&(s.kc("titleBarConfig",n.titleBarConfig),s.Cb(3),s.kc("ngForOf",n.output),s.Cb(3),s.Cc("",n.userSrv.userInfo.name,">"))},directives:[g.a,y.i],pipes:[S.a],styles:[".terminal[_ngcontent-%COMP%]{background-color:#000}.terminal[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#fff;font-size:14px;font-weight:100;word-break:break-all}.terminal[_ngcontent-%COMP%]   .typing-block[_ngcontent-%COMP%]   .typing-user[_ngcontent-%COMP%]{flex-shrink:0}.terminal[_ngcontent-%COMP%]   .typing-block[_ngcontent-%COMP%]   .typing-input[_ngcontent-%COMP%]{width:100%;height:100%}"]}),t})(),C=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({imports:[[e.a]]}),t})()}}]);